<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Theory &mdash; coolvib  documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="coolvib  documentation" href="index.html" />
    <link rel="next" title="Derivation" href="derivation.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">coolvib  documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="intro.html" title="Introduction"
             accesskey="P">previous</a> |
          <a href="derivation.html" title="Derivation"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="theory">
<span id="id1"></span><h1>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<p>The theory described below and the methods in <strong>coolvib</strong> are described in detail in <a class="reference internal" href="#askerka2016" id="id2">[Askerka2016]</a> and <a class="reference internal" href="#maurer2016" id="id3">[Maurer2016]</a>.</p>
<div class="section" id="non-adiabatic-friction-of-adsorbate-motion-on-metal-surfaces">
<h2>Non-adiabatic friction of adsorbate motion on metal surfaces<a class="headerlink" href="#non-adiabatic-friction-of-adsorbate-motion-on-metal-surfaces" title="Permalink to this headline">¶</a></h2>
<p>In insulating or most semi-conducting materials the energy spectrum of vibrations and electronic excitations are clearly separated. This is not the case for metals. In metals even the smallest vibrational motion can lead to electronic excitations due to the vanishing gap between occupied and unoccupied states.</p>
<div class="figure align-center" id="id8">
<a class="reference internal image-reference" href="_images/friction.png"><img alt="_images/friction.png" src="_images/friction.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text"><em>Figure 1: Schematic view of adsorbate vibration (here shown for a CO on Cu(100) internal stretch motion) leading to changes in the electronic structure that excite electron hole-pairs from below to above the Fermi level of the metal Density-of-States.</em></span></p>
</div>
<p>As shown in Figure 1, adsorbate motion can lead to changes in the electronic structure that facilitate low energy electronic excitations in the metal band structure. We can treat this interaction between electrons and vibrations with perturbation theory if the following assumptions are true:</p>
<blockquote>
<div><ul class="simple">
<li>the coupling is weak compared to the individual contributions of electrons and nuclei</li>
<li>electron-hole pair excitations do not lead to a qualitative change in the nuclear dynamics</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="non-adiabatic-relaxation-rates-from-first-order-time-dependent-perturbation-theory">
<h2>Non-adiabatic relaxation rates from first order time-dependent perturbation theory<a class="headerlink" href="#non-adiabatic-relaxation-rates-from-first-order-time-dependent-perturbation-theory" title="Permalink to this headline">¶</a></h2>
<p>The relaxation rate of a vibrational mode <img class="math" src="_images/math/0f2031547fef7549452db498d18de1923dd586f7.png" alt="\omega_{\mathbf{q}j}" style="vertical-align: -6px"/> due to nonadiabatic coupling is given by Fermi&#8217;s Golden Rule as derived from time-dependent perturbation theory and is given by:</p>
<div class="math" id="equation-gamma">
<p><span class="eqno">(1)</span><img src="_images/math/97089620e5339c1efedbb251d4c870dc4408d27e.png" alt="\Gamma_{\mathbf{q}j} = \frac{\pi\hbar}{M}\sum_{s\mathbf{k}}\sum_{\nu,\nu'} (f(\epsilon_{s\mathbf{k+q}\nu'})-f(\epsilon_{s\mathbf{k}\nu}))|g_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{\mathbf{q}j}|^2 \cdot (\epsilon_{s\mathbf{k+q}\nu'}-\epsilon_{s\mathbf{k}\nu}) \cdot\delta(\epsilon_{s\mathbf{k+q}\nu'}-\epsilon_{s\mathbf{k}\nu}-\hbar\omega_{\mathbf{q}j}),"/></p>
</div><p>where the sums run over spin, crystal momentum vectors <img class="math" src="_images/math/c5d47e1a75f7d42d0a9e18bfbd1ae09e84bf0487.png" alt="\mathbf{k}" style="vertical-align: -1px"/> and all pairs of eigenvectors <img class="math" src="_images/math/2b56587632cf6e99dc9a182c49075b9226642ee7.png" alt="\nu" style="vertical-align: 0px"/> and <img class="math" src="_images/math/3bd69e39ea6b4265b2b290a220b136de1aff4a90.png" alt="\nu'" style="vertical-align: 0px"/> with the state occupations <img class="math" src="_images/math/9267a350603c72b75aa262fafc6b99cccc3fa377.png" alt="f" style="vertical-align: -4px"/> given by the Fermi-Dirac distribution and the coupling elements <img class="math" src="_images/math/83f9c05180fab77d5c4abe6186baae6f62d4aca8.png" alt="g^{\mathbf{q}j}_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}" style="vertical-align: -8px"/></p>
<div class="math" id="equation-coupling">
<p><span class="eqno">(2)</span><img src="_images/math/cba654412e19ed9e6f05ef44958bf06322776ced.png" alt="g_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{\mathbf{q}j} = \braket{\psi_{s\mathbf{k+q}\nu'}|\mathbf{e}_{\mathbf{q}j}\nabla_{\mathbf{R}}\psi_{s\mathbf{k}\nu}}."/></p>
</div><p>For a detailed derivation of these equations see</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="derivation.html">Derivation</a></li>
</ul>
</div>
<p>The relaxation rate relates to the lifetime of the mode by <img class="math" src="_images/math/bc440ecd071c463218bade2ac19c5c5fabc75215.png" alt="\tau=1/\Gamma" style="vertical-align: -5px"/> and to the vibrational linewidth by <img class="math" src="_images/math/ea39a5b150e5b92dbfc0f168b395fc5e0a2cdf0d.png" alt="\gamma=\Gamma\hbar" style="vertical-align: -4px"/>. In eq. <a href="#equation-coupling">(2)</a> <img class="math" src="_images/math/6f95fce67c17390a78f3574928794782ea0fc24f.png" alt="\mathbf{e}_{\mathbf{q}j}" style="vertical-align: -6px"/> is the atomic displacement vector corresponding to a given vibrational motion <img class="math" src="_images/math/0f2031547fef7549452db498d18de1923dd586f7.png" alt="\omega_{\mathbf{q}j}" style="vertical-align: -6px"/> described by a wave-vector <img class="math" src="_images/math/fc8a8b20ced1e39afcaf498aab7fa894eecb48ac.png" alt="\mathbf{q}" style="vertical-align: -4px"/> and a quantum number <img class="math" src="_images/math/b3b72ec6eb3132f4ba17cfb6ec360cc2f7428f84.png" alt="j" style="vertical-align: -4px"/>. <img class="math" src="_images/math/f1ef91fd8f9f218dea047561f8d4103568de3635.png" alt="\nabla_{\mathbf{R}}" style="vertical-align: -3px"/> represents the derivative vector with respect to all cartesian atomic positions.</p>
<p>It is often assumed in literature <a class="reference internal" href="intro.html#head-gordon1995" id="id4">[Head-Gordon1995]</a>, <a class="reference internal" href="#hellsing1984" id="id5">[Hellsing1984]</a> that perturbations <img class="math" src="_images/math/ba327a3148c3739c4464485bec96be3b235af8a6.png" alt="\hbar\omega" style="vertical-align: 0px"/> due to vibrations are small and the density of state is almost constant in a large energy range around the Fermi level. This so-called quasi-static approximation leads to following simplification:</p>
<div class="math" id="equation-gamma2">
<p><span class="eqno">(3)</span><img src="_images/math/d060b8f3090bb7e81d2f7f73efdfe7db03d98eae.png" alt="\Gamma_{\mathbf{q}j} = \frac{\pi\hbar}{M}\sum_{s\mathbf{k}}\sum_{\nu,\nu'} (f(\epsilon_{s\mathbf{k+q}\nu'})-f(\epsilon_{s\mathbf{k}\nu}))|g_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{\mathbf{q}j}|^2 \cdot (\epsilon_{s\mathbf{k+q}\nu'}-\epsilon_{s\mathbf{k}\nu}) \cdot\delta(\epsilon_{s\mathbf{k+q}\nu'}-\epsilon_{s\mathbf{k}\nu})."/></p>
</div></div>
<div class="section" id="the-friction-tensor">
<h2>The Friction Tensor<a class="headerlink" href="#the-friction-tensor" title="Permalink to this headline">¶</a></h2>
<p>We can reformulate the matrix elements of expression <a href="#equation-coupling">(2)</a> in terms of a cartesian coupling tensor:</p>
<div class="math">
<p><img src="_images/math/fec8c23e951da8b7806abc197dc104edfda61d71.png" alt="|g_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{\mathbf{q}j}|^2 &amp;= g_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{\mathbf{q}j}\cdot g_{s\mathbf{k}\nu,s\mathbf{k+q}\nu'}^{\mathbf{q}j} = \\ &amp; \mathbf{e}^T_{\mathbf{q}j}\cdot\braket{\psi_{s\mathbf{k}\nu}|\mathbf{\nabla}_{\mathbf{R}}|\psi_{s\mathbf{k+q}\nu'}}\cdot\braket{\psi_{s\mathbf{k+q}\nu'}|\mathbf{\nabla}_{\mathbf{R}}|\psi_{s\mathbf{k}\nu}} \cdot\mathbf{e}_{\mathbf{q}j} = \\ &amp; \mathbf{e}^T_{\mathbf{q}j}\cdot \mathbf{G}_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}\cdot \mathbf{e}_{\mathbf{q}j}."/></p>
</div><p>The elements of G are defined as:</p>
<div class="math">
<p><img src="_images/math/64711fb03e990a2bdf19360b4b55abdd6bda29c2.png" alt="\mathbf{G}_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} = \braket{\psi_{s\mathbf{k}\nu}|\frac{\partial}{\partial_{a}\mathbf{R}_{n}}|\psi_{s\mathbf{k+q}\nu'}} \cdot \braket{\psi_{s\mathbf{k+q}\nu'}|\frac{\partial}{\partial_{a'}\mathbf{R}_{n'}}|\psi_{s\mathbf{k}\nu}} ,"/></p>
</div><p>where n and n&#8217; indicate the n-th (n&#8217;-th) atom and a and a&#8217; indicate one of the three cartesian directions x, y, and z. Inserting <strong>G</strong> into eq. <a href="#equation-gamma2">(3)</a> we arrive at:</p>
<div class="math" id="equation-friction">
<p><span class="eqno">(4)</span><img src="_images/math/fb57f68b1a002feb5969e5069d744d0447f99cbb.png" alt="\Gamma(\omega_{\mathbf{q}j}) &amp;=  \mathbf{e}^T_{\mathbf{q}j}\cdot  \biggl( \pi\sum_{s,\mathbf{k},\nu,\nu'} \mathbf{G}_{s\mathbf{k+q}\nu',s\mathbf{k}\nu} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))  \\ \nonumber &amp;    \cdot\delta(\epsilon_{\mathbf{k}\nu}-\epsilon_{\mathbf{k+q}\nu'}) \biggr) \cdot \mathbf{e}_{\mathbf{q}j} = \mathbf{e}^T_{\mathbf{q}j}\cdot\Lambda^{\mathbf{q}}\cdot\mathbf{e}_{\mathbf{q}j}."/></p>
</div><p>In eq. <a href="#equation-friction">(4)</a> we have defined the friction tensor <img class="math" src="_images/math/ce5e408b1403adc5a3d28084b449ff7109f8f443.png" alt="\mathbf{\Lambda}^{\mathbf{q}}" style="vertical-align: -1px"/> with dimensions <img class="math" src="_images/math/9dffcfb42f18d96ae34258039181fb4532c80323.png" alt="(3N\times3N)" style="vertical-align: -4px"/> where N is the number of atoms. The elements of  <img class="math" src="_images/math/ce5e408b1403adc5a3d28084b449ff7109f8f443.png" alt="\mathbf{\Lambda}^{\mathbf{q}}" style="vertical-align: -1px"/> are defined as</p>
<div class="math" id="equation-friction-tensor">
<p><span class="eqno">(5)</span><img src="_images/math/d8b863331fbdbb348ae1e9d2c60e02f7ea827c34.png" alt="\Lambda^{\mathbf{q}}_{n'a',na} = \frac{\pi\hbar}{\sqrt{M_{n'}}\sqrt{M_n}} \sum_{s,\mathbf{k},\nu,\nu'} G_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))\cdot(\epsilon_{s\mathbf{k+q}\nu'}-\epsilon_{s\mathbf{k}\nu}) \cdot\delta(\epsilon_{\mathbf{k}\nu}-\epsilon_{\mathbf{k+q}\nu'}) ."/></p>
</div></div>
<div class="section" id="vibrational-relaxation-rates-of-adsorbates">
<h2>Vibrational relaxation rates of adsorbates<a class="headerlink" href="#vibrational-relaxation-rates-of-adsorbates" title="Permalink to this headline">¶</a></h2>
<p>Eq. <a href="#equation-friction">(4)</a> shows that using the friction tensor one can calculate relaxation rates and vibrational lifetimes for arbitrary molecular motions.</p>
<div class="figure align-center" id="id9">
<a class="reference internal image-reference" href="_images/motion1.png"><img alt="_images/motion1.png" src="_images/motion1.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">Figure 2: Collective motion of a periodic overlayer of CO atoms on Cu(100)</span></p>
</div>
<p>Considering periodic boundary conditions, the collective motion of an adsorbate overlayer (as shown in Fig. 2) can be described with a single adsorbate vibrational mode with wave vector <img class="math" src="_images/math/463ed99ce2e0fbb9fa42803df756402d5ed8bd11.png" alt="q=0" style="vertical-align: -4px"/>. The corresponding relaxatio rate for this vibration is given by:</p>
<div class="math" id="equation-rate-default">
<p><span class="eqno">(6)</span><img src="_images/math/92e3d66c450638518087413944318cdb68141099.png" alt="\Gamma(\omega_j) = \mathbf{e}^T_j\cdot\Gamma^{\mathbf{q}=0}\cdot\mathbf{e}_j"/></p>
</div><p>Calculation of vibrational cooling using this approach is the most common <a class="reference internal" href="intro.html#head-gordon1992" id="id6">[Head-Gordon1992]</a> , <a class="reference internal" href="intro.html#persson1982" id="id7">[Persson1982]</a> and is the <em>default</em> setting when calculating lifetimes in <strong>coolvib</strong>.</p>
<div class="figure align-center" id="id10">
<a class="reference internal image-reference" href="_images/motion2.png"><img alt="_images/motion2.png" src="_images/motion2.png" style="width: 70%;" /></a>
<p class="caption"><span class="caption-text">Figure 3: Motion of only one CO atom adsorbed on Cu(100), effectively breaking periodicity.</span></p>
</div>
<p>When considering the lifetime due to motion of a single adsorbate, such as is the case for impinging adsorbates,
low coverages or non-collective adlayer motion (see Fig. 3) one effectively needs to integrate over all possible vibrations of the same type with different wave vectors <img class="math" src="_images/math/fc8a8b20ced1e39afcaf498aab7fa894eecb48ac.png" alt="\mathbf{q}" style="vertical-align: -4px"/>, effectively amounting to a Fourier expansion in reciprocal space. Correspondingly, the relaxation rate is given by:</p>
<div class="math" id="equation-rate-momentum">
<p><span class="eqno">(7)</span><img src="_images/math/38fe36a749237399a80a6c342962987c19134e61.png" alt="\Gamma(\omega_{\mathbf{q}j}) = \sum_{\mathbf{q}} \mathbf{e}^T_{\mathbf{q}j}\cdot\Gamma^{\mathbf{q}}\cdot\mathbf{e}_{\mathbf{qj}} \approx  \mathbf{e}^T_j\cdot\Gamma^{\sum \mathbf{q}}\cdot\mathbf{e}_j"/></p>
</div><p>In the corresponding relaxation rate, we additionally include excitations that in principle violate momentum-conservation. If we assume that adsorbate vibrations interact only by simple phase modulation we can assume the atomic displacements of individual adsorbate images to be independent of wave vector yielding following expression for the friction tensor in this case:</p>
<div class="math" id="equation-friction-tensor-q">
<p><span class="eqno">(8)</span><img src="_images/math/6c02dbe07cc6c0fc0edaaa519d8d048af8e6aaf9.png" alt="\Lambda^{\sum \mathbf{q}}_{n'a',na} = \frac{\pi\hbar}{\sqrt{M_{n'}}\sqrt{M_n}} \sum_{s} \sum_{\mathbf{q}}\sum_{\mathbf{k}} \sum_{\nu,\nu'} G_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))\cdot(\epsilon_{s\mathbf{k+q}\nu'}-\epsilon_{s\mathbf{k}\nu}) \cdot\delta(\epsilon_{\mathbf{k}\nu}-\epsilon_{\mathbf{k+q}\nu'}) ."/></p>
</div></div>
<div class="section" id="numerical-considerations-and-working-equations">
<h2>Numerical considerations and working equations<a class="headerlink" href="#numerical-considerations-and-working-equations" title="Permalink to this headline">¶</a></h2>
<p>Depending on if one wants to calculate vibrational lifetimes of periodic overlayers or
single adsorbates one is left with evaluating eqs. <a href="#equation-friction-tensor">(5)</a> or <a href="#equation-friction-tensor-q">(8)</a>.
This is by no means a simple task due to the slow convergence of electronic structure close to the
Fermi level and intricacies of evaluating a delta function in a non-equidistant space of excitations.</p>
<p>Some of these issues can be solved by transforming the equation into a continuous representation using the
the Density-of-State of the system:</p>
<div class="math">
<p><img src="_images/math/8efab3e438730734ae120dc7d9ebb54cd8f64400.png" alt="\sum_{\nu} 1= \sum_{\nu} \int_{-\infty}^{\infty} d\epsilon_a\cdot \delta(\epsilon_a-\epsilon_{\nu})= \int_{-\infty}^{\infty} d\epsilon_a\cdot \underbrace{\sum_{\nu} \delta(\epsilon_a-\epsilon_{\nu})}_{\rho(\epsilon)}"/></p>
</div><p>Introducing the Density-of-State for both sums over eigenstates in <a href="#equation-friction-tensor">(5)</a> we arrive at</p>
<div class="math">
<p><img src="_images/math/8b7d6b5d3b1aa097c7d3d1b661421b2681f363ac.png" alt="\Lambda^{\mathbf{q}}_{n'a',na} = \frac{\pi\hbar}{\sqrt{M_{n'}}\sqrt{M_n}}  \int_{-\infty}^{\epsilon_F} d\epsilon_a\int_{\epsilon_F}^{\infty} d\epsilon_b \sum_{s,\mathbf{k}}\sum_{\nu}\sum_{\nu'} G_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))\cdot\delta(\epsilon_a-\epsilon_{s\mathbf{k}\nu})\cdot\delta(\epsilon_b-\epsilon_{s\mathbf{k+q}\nu'})\cdot\epsilon \cdot\delta(\epsilon_{a}-\epsilon_{b}) ."/></p>
</div><p>The change in variable from the discrete space to the continuous space for the last delta function and the energy difference can be understood as a consequence of sequentially evaluating the first to delta functions (and by equivalence)
Now we change the integration variables from occupied and unoccupied states to excitation energies</p>
<div class="math">
<p><img src="_images/math/3fb664379891a5d39ea8ddb6dbd99dcc0f4dba66.png" alt="\epsilon = \epsilon_b - \epsilon_a \Rightarrow d\epsilon_b=d\epsilon+\epsilon_a"/></p>
</div><p>and arrive at</p>
<div class="math">
<p><img src="_images/math/71a1b5e4ddbc9ede5ade28255ea1009e6d5f74a9.png" alt="\Lambda^{\mathbf{q}}_{n'a',na} = \frac{\pi\hbar}{\sqrt{M_{n'}}\sqrt{M_n}}  \int_{-\infty}^{\epsilon_F} d\epsilon_a\int_{\epsilon_F}^{\infty} (d\epsilon+d\epsilon_a) \sum_{s,\mathbf{k}}\sum_{\nu}\sum_{\nu'} G_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))\cdot\delta(\epsilon_a-\epsilon_{s\mathbf{k}\nu})\cdot\delta(\epsilon+\epsilon_a-\epsilon_{s\mathbf{k+q}\nu'})\cdot\epsilon \cdot\delta(-\epsilon) ="/></p>
</div><div class="math" id="equation-friction-derivation">
<p><span class="eqno">(9)</span><img src="_images/math/bf16070934f716576b61686656f0339ce0188a38.png" alt="&amp;= \frac{\pi\hbar}{\sqrt{M_{n'}}\sqrt{M_n}}  \int_{-\infty}^{\epsilon_F} d\epsilon_a\int_{\epsilon_F}^{\infty} d\epsilon_a \sum_{s,\mathbf{k}}\sum_{\nu}\sum_{\nu'} G_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))\cdot\delta(\epsilon_a-\epsilon_{s\mathbf{k}\nu})\cdot\delta(\epsilon+\epsilon_a-\epsilon_{s\mathbf{k+q}\nu'})\cdot\epsilon \cdot\delta(-\epsilon) = \\
&amp;= \frac{\pi\hbar}{\sqrt{M_{n'}}\sqrt{M_n}}  \int_{-\infty}^{\epsilon_F} d\epsilon_a\int_{-\infty}^{\infty} d\epsilon \sum_{s,\mathbf{k}}\sum_{\nu}\sum_{\nu'} G_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))\cdot\delta(\epsilon_a-\epsilon_{s\mathbf{k}\nu})\cdot\delta(\epsilon+\epsilon_a-\epsilon_{s\mathbf{k+q}\nu'})\cdot\epsilon \cdot\delta(-\epsilon)"/></p>
</div><p>The first term in eq. <a href="#equation-friction-derivation">(9)</a> vanishes because the integration variable for occupied states <img class="math" src="_images/math/f62d8e6f41bdf0b668b51e882e58e6e348364125.png" alt="d\epsilon_a" style="vertical-align: -3px"/> is not defined in the range between <img class="math" src="_images/math/ad243f13f61b3048645a3df6496c55209117c269.png" alt="\infty" style="vertical-align: -1px"/> and <img class="math" src="_images/math/37a629775c77efc90116fe204fd9bb7f46616e2f.png" alt="\epsilon_F" style="vertical-align: -3px"/>. In the second term we can use the following properties of delta functions</p>
<div class="math">
<p><img src="_images/math/92f9f0bc78261024a999ae95b282178e6c115946.png" alt="\int \delta(\epsilon_a-\epsilon_{s\mathbf{k}\nu})\delta(\epsilon+\epsilon_a-\epsilon_{s\mathbf{k+q}\nu'})=\delta(\epsilon+\epsilon_{s\mathbf{k}\nu}-\epsilon_{s\mathbf{k+q}\nu'})"/></p>
</div><p>and</p>
<div class="math">
<p><img src="_images/math/d946a6ca096a1ffbdcd4f0c565945e6b7330f825.png" alt="\delta(-x) = \delta(x)"/></p>
</div><p>to arrive at</p>
<div class="math" id="equation-friction-tensor-new">
<p><span class="eqno">(10)</span><img src="_images/math/38fc1c8d58b9a45af05386761ef08cb3ecf26216.png" alt="\Lambda^{\mathbf{q}}_{n'a',na} = \int_{-\infty}^{\infty} d\epsilon \cdot\epsilon \cdot\delta(\epsilon) \cdot\underbrace{\sum_{s,\mathbf{k}}\sum_{\nu}\sum_{\nu'}\frac{\pi\hbar}{\sqrt{M_{n'}}\sqrt{M_n}}  G_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))\cdot\delta(\epsilon_{s\mathbf{k+q}\nu'}-\epsilon_{s\mathbf{k}\nu}-\epsilon) }_{A_{n'a',na}(\epsilon)}"/></p>
</div><p>By rewriting the friction tensor in this way we have gained several things:</p>
<blockquote>
<div><ul class="simple">
<li>The continuous formulation enables simple numerical discretization and accurate evaluation of the delta function <img class="math" src="_images/math/b8441c085be8ce8d4feb5b24f3e1ceeb2ac81e9a.png" alt="\delta(\epsilon)" style="vertical-align: -4px"/>, thereby reducing numerical instabilities.</li>
<li>We have defined a set of <strong>electron-phonon spectral functions</strong> <img class="math" src="_images/math/9f08e599302403a136cd73a52eeefd5a4b670c09.png" alt="A_{n'a',na}(\epsilon)" style="vertical-align: -6px"/> for all combinations of cartesian components, which describe the principal spectrum of available coupling channels between electronic and nuclear degrees of freedom.</li>
<li>The second delta function transforms the set of finite transitions into smooth continuous spectral functions and therefore improves convergence with respect to Brillouin zone sampling.</li>
</ul>
</div></blockquote>
<p>The expression for the spectral functions</p>
<div class="math" id="equation-spectral-function1">
<p><span class="eqno">(11)</span><img src="_images/math/9ac739f4878c496f60e61d0e86e615005321a836.png" alt="A_{n'a',na}(\epsilon) = \sum_{s,\mathbf{k}}\sum_{\nu}\sum_{\nu'}\frac{\pi\hbar}{\sqrt{M_{n'}}\sqrt{M_n}}  G_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))\cdot\delta(\epsilon_{s\mathbf{k+q}\nu'}-\epsilon_{s\mathbf{k}\nu}-\epsilon)"/></p>
</div><p>and its corresponding equivalent for isolated adsorbates</p>
<div class="math" id="equation-spectral-function2">
<p><span class="eqno">(12)</span><img src="_images/math/6b7f8b42eac5feaa1c609936a964d24025635d2d.png" alt="A_{n'a',na}^{\sum \mathbf{q}}(\epsilon) = \sum_{s,\mathbf{q},\mathbf{k}}\sum_{\nu}\sum_{\nu'}\frac{\pi\hbar}{\sqrt{M_{n'}}\sqrt{M_n}}  G_{s\mathbf{k+q}\nu',s\mathbf{k}\nu}^{n'a',na} \cdot(f(\epsilon_{\mathbf{k}\nu})-f(\epsilon_{\mathbf{k+q}\nu'}))\cdot\delta(\epsilon_{s\mathbf{k+q}\nu'}-\epsilon_{s\mathbf{k}\nu}-\epsilon)"/></p>
</div><div class="math">
<p><img src="_images/math/40fdb31195b53066025da110a270796e2712f65e.png" alt=""/></p>
</div><p>represent the main working equations of this software.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils citation" frame="void" id="askerka2016" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[Askerka2016]</a></td><td><ol class="first last upperalpha simple" start="13">
<li>Askerka, R. J. Maurer, V. S. Batista, J. C. Tully, Phys. Rev. Lett. 116, 217601 (2016)</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="maurer2016" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[Maurer2016]</a></td><td><ol class="first last upperalpha simple" start="18">
<li><ol class="first upperalpha" start="10">
<li>Maurer, M. Askerka, V. S. Batista, J. C. Tully, Phys. Rev. B, under Review (2016)</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hellsing1984" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[Hellsing1984]</a></td><td><cite>B.</cite> Hellsing, and M. Persson, <em>Physi. Scripta</em> <strong>29</strong>, 360-371 (1984)</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html"> Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href=""> Theory and Methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#non-adiabatic-friction-of-adsorbate-motion-on-metal-surfaces">Non-adiabatic friction of adsorbate motion on metal surfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#non-adiabatic-relaxation-rates-from-first-order-time-dependent-perturbation-theory">Non-adiabatic relaxation rates from first order time-dependent perturbation theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-friction-tensor">The Friction Tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#vibrational-relaxation-rates-of-adsorbates">Vibrational relaxation rates of adsorbates</a></li>
<li class="toctree-l2"><a class="reference internal" href="#numerical-considerations-and-working-equations">Numerical considerations and working equations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html"> Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="coolvib.html"> Coolvib: Modules and Classes</a></li>
</ul>

          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
            <p class="searchtip" style="font-size: 90%">
                Enter search terms or a module, class or function name.
            </p>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="intro.html" title="Introduction"
              >previous</a> |
            <a href="derivation.html" title="Derivation"
              >next</a> |
            <a href="py-modindex.html" title="Python Module Index"
              >modules</a> |
            <a href="genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="_sources/methods.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Reinhard J. Maurer.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>